group 'hoopoe-profiler'
version '0.1.0-SNAPSHOT'

buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath group: 'org.zeroturnaround', name: 'gradle-jrebel-plugin', version: '1.1.3'
    }
}

allprojects {
    repositories {
        mavenCentral()
    }

    configurations {
        provided
        compile.extendsFrom provided
        hoopoe
    }

}

subprojects {

    plugins.withType(JavaPlugin) {
        //plugins.apply(JacocoPlugin)
    }

    gradle.projectsEvaluated {

        tasks.withType(JacocoReport) {
            it.reports.xml.enabled = true;
            it.reports.html.enabled = false;
            tasks.findByName('check').dependsOn(it)
        }

        tasks.withType(Jar) {
            def generateRebelTask = project.tasks.findByName('generateRebel')
            if (generateRebelTask) {
                dependsOn(generateRebelTask)
            }
        }

        tasks.withType(JavaCompile) {
            options.compilerArgs << '-nowarn'
            sourceCompatibility = 1.8
        }
    }
}